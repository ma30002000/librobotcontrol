
add_definitions(-DRC_AUTOPILOT_EXT)

add_compile_options(
	-Wno-cast-align
	-Wno-logical-op
	-Wno-strict-prototypes
)

add_library(robotics_cape
	src/button.c
	src/cpu.c
	src/dsm.c
	src/led.c
	src/mavlink_udp.c
	src/model.c
	src/motor.c
	src/pinmux.c
	src/pthread.c
	src/start_stop.c
	src/time.c
	src/version.c
	src/bmp/bmp.c
	src/io/adc.c
	src/io/encoder_eqep.c
	src/io/gpio.c
	src/io/i2c.c
	src/io/pwm.c
	src/io/spi.c
	src/io/uart.c
	src/math/algebra.c
	src/math/algebra_common.c
	src/math/filter.c
	src/math/matrix.c
	src/math/other.c
	src/math/polynomial.c
	src/math/quaternion.c
	src/math/ring_buffer.c
	src/math/vector.c
	src/mpu/mpu.c
	src/pru/encoder_pru.c
	src/pru/pru.c
	src/pru/servo.c
)

set (INCLUDE_FILES
	include/rc/version.h
	include/rc/spi.h
	include/rc/button.h
	include/rc/math/filter.h
	include/rc/math/ring_buffer.h
	include/rc/math/other.h
	include/rc/math/polynomial.h
	include/rc/math/quaternion.h
	include/rc/math/matrix.h
	include/rc/math/kalman.h
	include/rc/math/algebra.h
	include/rc/math/vector.h
	include/rc/time.h
	include/rc/uart.h
	include/rc/encoder.h
	include/rc/mavlink/mavlink_helpers.h
	include/rc/mavlink/mavlink_sha256.h
	include/rc/mavlink/mavlink_get_info.h
	include/rc/mavlink/protocol.h
	include/rc/mavlink/checksum.h
	include/rc/mavlink/common/version.h
	include/rc/mavlink/common/mavlink_msg_sys_status.h
	include/rc/mavlink/common/mavlink_msg_log_data.h
	include/rc/mavlink/common/mavlink_msg_gps2_rtk.h
	include/rc/mavlink/common/mavlink_msg_flight_information.h
	include/rc/mavlink/common/mavlink_msg_command_ack.h
	include/rc/mavlink/common/mavlink_msg_logging_data_acked.h
	include/rc/mavlink/common/mavlink_msg_video_stream_information.h
	include/rc/mavlink/common/mavlink_msg_uavcan_node_status.h
	include/rc/mavlink/common/mavlink_msg_local_position_ned_system_global_offset.h
	include/rc/mavlink/common/mavlink_msg_terrain_report.h
	include/rc/mavlink/common/mavlink_msg_hil_rc_inputs_raw.h
	include/rc/mavlink/common/mavlink_msg_mission_request.h
	include/rc/mavlink/common/mavlink_msg_heartbeat.h
	include/rc/mavlink/common/mavlink_msg_file_transfer_protocol.h
	include/rc/mavlink/common/mavlink_msg_camera_trigger.h
	include/rc/mavlink/common/mavlink_msg_debug.h
	include/rc/mavlink/common/mavlink_msg_safety_set_allowed_area.h
	include/rc/mavlink/common/mavlink_msg_power_status.h
	include/rc/mavlink/common/mavlink_msg_mission_count.h
	include/rc/mavlink/common/mavlink_msg_attitude.h
	include/rc/mavlink/common/mavlink_msg_ping.h
	include/rc/mavlink/common/mavlink_msg_button_change.h
	include/rc/mavlink/common/mavlink_msg_scaled_imu.h
	include/rc/mavlink/common/mavlink_msg_auth_key.h
	include/rc/mavlink/common/mavlink_msg_param_ext_value.h
	include/rc/mavlink/common/mavlink_msg_mission_request_list.h
	include/rc/mavlink/common/mavlink_msg_mission_item.h
	include/rc/mavlink/common/mavlink_msg_camera_information.h
	include/rc/mavlink/common/mavlink_msg_wind_cov.h
	include/rc/mavlink/common/mavlink_msg_named_value_int.h
	include/rc/mavlink/common/mavlink_msg_servo_output_raw.h
	include/rc/mavlink/common/mavlink_msg_wifi_config_ap.h
	include/rc/mavlink/common/mavlink_msg_gps_rtcm_data.h
	include/rc/mavlink/common/mavlink_msg_mission_item_reached.h
	include/rc/mavlink/common/mavlink_msg_adsb_vehicle.h
	include/rc/mavlink/common/mavlink_msg_scaled_imu2.h
	include/rc/mavlink/common/mavlink_msg_hil_state.h
	include/rc/mavlink/common/mavlink_msg_set_position_target_local_ned.h
	include/rc/mavlink/common/mavlink_msg_rc_channels_raw.h
	include/rc/mavlink/common/mavlink_msg_mission_request_int.h
	include/rc/mavlink/common/mavlink_msg_manual_setpoint.h
	include/rc/mavlink/common/mavlink_msg_gps_input.h
	include/rc/mavlink/common/mavlink_msg_hil_controls.h
	include/rc/mavlink/common/mavlink_msg_serial_control.h
	include/rc/mavlink/common/mavlink_msg_raw_imu.h
	include/rc/mavlink/common/mavlink_msg_timesync.h
	include/rc/mavlink/common/mavlink_msg_global_position_int.h
	include/rc/mavlink/common/mavlink_msg_change_operator_control_ack.h
	include/rc/mavlink/common/mavlink_msg_param_map_rc.h
	include/rc/mavlink/common/mavlink_msg_local_position_ned_cov.h
	include/rc/mavlink/common/mavlink_msg_hil_sensor.h
	include/rc/mavlink/common/mavlink_msg_altitude.h
	include/rc/mavlink/common/mavlink_msg_command_int.h
	include/rc/mavlink/common/mavlink_msg_mission_ack.h
	include/rc/mavlink/common/mavlink_msg_raw_pressure.h
	include/rc/mavlink/common/mavlink_msg_manual_control.h
	include/rc/mavlink/common/mavlink_msg_actuator_control_target.h
	include/rc/mavlink/common/mavlink_msg_gps2_raw.h
	include/rc/mavlink/common/mavlink_msg_storage_information.h
	include/rc/mavlink/common/mavlink_msg_v2_extension.h
	include/rc/mavlink/common/mavlink_msg_attitude_quaternion_cov.h
	include/rc/mavlink/common/mavlink_msg_param_ext_request_read.h
	include/rc/mavlink/common/mavlink_msg_highres_imu.h
	include/rc/mavlink/common/mavlink_msg_vfr_hud.h
	include/rc/mavlink/common/mavlink_msg_control_system_state.h
	include/rc/mavlink/common/mavlink_msg_safety_allowed_area.h
	include/rc/mavlink/common/mavlink_msg_rc_channels_scaled.h
	include/rc/mavlink/common/mavlink_msg_gps_global_origin.h
	include/rc/mavlink/common/mavlink_msg_battery_status.h
	include/rc/mavlink/common/mavlink_msg_play_tune.h
	include/rc/mavlink/common/mavlink_msg_nav_controller_output.h
	include/rc/mavlink/common/mavlink_msg_camera_image_captured.h
	include/rc/mavlink/common/mavlink_msg_position_target_global_int.h
	include/rc/mavlink/common/mavlink_msg_request_data_stream.h
	include/rc/mavlink/common/mavlink.h
	include/rc/mavlink/common/mavlink_msg_set_attitude_target.h
	include/rc/mavlink/common/mavlink_msg_gps_raw_int.h
	include/rc/mavlink/common/mavlink_msg_param_set.h
	include/rc/mavlink/common/mavlink_msg_set_mode.h
	include/rc/mavlink/common/mavlink_msg_optical_flow_rad.h
	include/rc/mavlink/common/mavlink_msg_attitude_quaternion.h
	include/rc/mavlink/common/mavlink_msg_data_stream.h
	include/rc/mavlink/common/mavlink_msg_local_position_ned.h
	include/rc/mavlink/common/mavlink_msg_hil_gps.h
	include/rc/mavlink/common/mavlink_msg_set_gps_global_origin.h
	include/rc/mavlink/common/mavlink_msg_data_transmission_handshake.h
	include/rc/mavlink/common/mavlink_msg_attitude_target.h
	include/rc/mavlink/common/mavlink_msg_rc_channels_override.h
	include/rc/mavlink/common/mavlink_msg_att_pos_mocap.h
	include/rc/mavlink/common/common.h
	include/rc/mavlink/common/mavlink_msg_message_interval.h
	include/rc/mavlink/common/mavlink_msg_obstacle_distance.h
	include/rc/mavlink/common/mavlink_msg_gps_status.h
	include/rc/mavlink/common/mavlink_msg_global_vision_position_estimate.h
	include/rc/mavlink/common/mavlink_msg_set_video_stream_settings.h
	include/rc/mavlink/common/mavlink_msg_memory_vect.h
	include/rc/mavlink/common/mavlink_msg_logging_ack.h
	include/rc/mavlink/common/mavlink_msg_log_request_end.h
	include/rc/mavlink/common/mavlink_msg_hil_state_quaternion.h
	include/rc/mavlink/common/mavlink_msg_debug_vect.h
	include/rc/mavlink/common/mavlink_msg_gps_inject_data.h
	include/rc/mavlink/common/mavlink_msg_mission_current.h
	include/rc/mavlink/common/mavlink_msg_terrain_check.h
	include/rc/mavlink/common/mavlink_msg_collision.h
	include/rc/mavlink/common/mavlink_msg_param_request_read.h
	include/rc/mavlink/common/mavlink_msg_hil_actuator_controls.h
	include/rc/mavlink/common/mavlink_msg_param_request_list.h
	include/rc/mavlink/common/mavlink_msg_rc_channels.h
	include/rc/mavlink/common/mavlink_msg_global_position_int_cov.h
	include/rc/mavlink/common/mavlink_msg_named_value_float.h
	include/rc/mavlink/common/mavlink_msg_set_actuator_control_target.h
	include/rc/mavlink/common/mavlink_msg_optical_flow.h
	include/rc/mavlink/common/mavlink_msg_vicon_position_estimate.h
	include/rc/mavlink/common/mavlink_msg_position_target_local_ned.h
	include/rc/mavlink/common/mavlink_msg_log_erase.h
	include/rc/mavlink/common/mavlink_msg_gps_rtk.h
	include/rc/mavlink/common/mavlink_msg_vision_speed_estimate.h
	include/rc/mavlink/common/mavlink_msg_distance_sensor.h
	include/rc/mavlink/common/mavlink_msg_vision_position_estimate.h
	include/rc/mavlink/common/mavlink_msg_uavcan_node_info.h
	include/rc/mavlink/common/mavlink_msg_system_time.h
	include/rc/mavlink/common/mavlink_msg_mission_item_int.h
	include/rc/mavlink/common/mavlink_msg_terrain_request.h
	include/rc/mavlink/common/mavlink_msg_scaled_pressure2.h
	include/rc/mavlink/common/mavlink_msg_scaled_imu3.h
	include/rc/mavlink/common/mavlink_msg_mount_orientation.h
	include/rc/mavlink/common/mavlink_msg_estimator_status.h
	include/rc/mavlink/common/mavlink_msg_hil_optical_flow.h
	include/rc/mavlink/common/mavlink_msg_camera_settings.h
	include/rc/mavlink/common/mavlink_msg_home_position.h
	include/rc/mavlink/common/mavlink_msg_camera_capture_status.h
	include/rc/mavlink/common/mavlink_msg_mission_set_current.h
	include/rc/mavlink/common/mavlink_msg_protocol_version.h
	include/rc/mavlink/common/mavlink_msg_log_request_data.h
	include/rc/mavlink/common/mavlink_msg_extended_sys_state.h
	include/rc/mavlink/common/mavlink_msg_high_latency.h
	include/rc/mavlink/common/mavlink_msg_param_ext_set.h
	include/rc/mavlink/common/mavlink_msg_set_home_position.h
	include/rc/mavlink/common/mavlink_msg_set_position_target_global_int.h
	include/rc/mavlink/common/mavlink_msg_scaled_pressure3.h
	include/rc/mavlink/common/mavlink_msg_terrain_data.h
	include/rc/mavlink/common/mavlink_msg_log_request_list.h
	include/rc/mavlink/common/mavlink_msg_change_operator_control.h
	include/rc/mavlink/common/mavlink_msg_param_ext_ack.h
	include/rc/mavlink/common/mavlink_msg_param_value.h
	include/rc/mavlink/common/mavlink_msg_command_long.h
	include/rc/mavlink/common/mavlink_msg_scaled_pressure.h
	include/rc/mavlink/common/mavlink_msg_mission_request_partial_list.h
	include/rc/mavlink/common/mavlink_msg_mission_clear_all.h
	include/rc/mavlink/common/mavlink_msg_statustext.h
	include/rc/mavlink/common/mavlink_msg_log_entry.h
	include/rc/mavlink/common/mavlink_msg_radio_status.h
	include/rc/mavlink/common/mavlink_msg_param_ext_request_list.h
	include/rc/mavlink/common/testsuite.h
	include/rc/mavlink/common/mavlink_msg_autopilot_version.h
	include/rc/mavlink/common/mavlink_msg_sim_state.h
	include/rc/mavlink/common/mavlink_msg_follow_target.h
	include/rc/mavlink/common/mavlink_msg_logging_data.h
	include/rc/mavlink/common/mavlink_msg_mission_write_partial_list.h
	include/rc/mavlink/common/mavlink_msg_setup_signing.h
	include/rc/mavlink/common/mavlink_msg_encapsulated_data.h
	include/rc/mavlink/common/mavlink_msg_resource_request.h
	include/rc/mavlink/common/mavlink_msg_vibration.h
	include/rc/mavlink/common/mavlink_msg_landing_target.h
	include/rc/mavlink/mavlink_conversions.h
	include/rc/mavlink/mavlink_types.h
	include/rc/pinmux.h
	include/rc/model.h
	include/rc/pwm.h
	include/rc/mavlink_udp_helpers.h
	include/rc/cpu.h
	include/rc/mpu.h
	include/rc/dsm.h
	include/rc/i2c.h
	include/rc/math.h
	include/rc/bmp.h
	include/rc/pru.h
	include/rc/led.h
	include/rc/start_stop.h
	include/rc/motor.h
	include/rc/encoder_pru.h
	include/rc/adc.h
	include/rc/gpio.h
	include/rc/servo.h
	include/rc/pthread.h
	include/rc/mavlink_udp.h
	include/rc/encoder_eqep.h
	include/robotcontrol.h
)

target_sources(robotics_cape PUBLIC
		FILE_SET public_headers
		TYPE HEADERS
		BASE_DIRS include
		FILES ${INCLUDE_FILES})

target_link_libraries(robotics_cape PRIVATE m)

install(TARGETS robotics_cape FILE_SET public_headers)
install(TARGETS robotics_cape TYPE ARCHIVE)